فقط ابتدای فایل script.js که هست رو اینطور تغییر بدین:

// بجای showAlert، از همون تابع موجود استفاده می‌کنیم
// فقط کدهای مربوط به ورود رو بروزرسانی بکنه

document.addEventListener("DOMContentLoaded", async function () {
    const loginForm = document.querySelector("form");
    const submitBtn = loginForm.querySelector("button[type='submit']");

    // بررسی اولیه ورود
    const accessToken = localStorage.getItem("access_token");
    if (accessToken) {
        const loginResult = await auth.loginWithToken(accessToken);
        if (loginResult.success) {
            auth.redirectUserByType();
            return;
        }
    }

    // نمایش فرم ورود
    loginForm.style.display = "block";

    // مدیریت ورود
    loginForm.addEventListener("submit", async function (e) {
        e.preventDefault();

        const idCode = document.getElementById("id_code").value.trim();
        const password = document.getElementById("password").value;
        const remember = document.getElementById("remember_me").checked;

        if (!idCode || !password) {
            showAlert("لطفاً تمام فیلدها را پر کنید.");
            return;
        }

        // غیرفعال کردن دکمه
        submitBtn.disabled = true;
        submitBtn.innerText = "در حال ورود...";

        // تلاش برای ورود
        const loginResult = await auth.login(idCode, password, remember);

        if (loginResult.success) {
            // هدایت بر اساس نوع کاربر
            auth.redirectUserByType();
        } else {
            showAlert("خطا در ورود: " + loginResult.error);
            submitBtn.disabled = false;
            submitBtn.innerText = "ورود";
        }
    });
});




--------------------------------------------------------------------------------


 استفاده در صفحات داشبورد

 // در ابتدای هر صفحه داشبورد بزار
document.addEventListener('DOMContentLoaded', function() {
    // بررسی ورود
    if (!auth.isAuthenticated()) {
        window.location.href = '/login/';
        return;
    }

    // مثال: بارگذاری داده‌ها
    loadData();
});

// مثال استفاده از API
async function loadData() {
    const result = await api.getStudentScores();
    if (result.success) {
        console.log('نمرات:', result.data);
        // نمایش داده‌ها
    } else {
        showAlert('خطا در بارگذاری داده‌ها: ' + result.error);
    }
}

// مثال ثبت نمره
async function submitNewScore() {
    const studentId = document.getElementById('student-id').value;
    const scoreTitle = document.getElementById('score-title').value;
    const scoreValue = document.getElementById('score-value').value;

    const result = await api.submitScore(studentId, scoreTitle, scoreValue);
    if (result.success) {
        showAlert('نمره با موفقیت ثبت شد', 'success');
        // بروزرسانی صفحه
    } else {
        showAlert('خطا در ثبت نمره: ' + result.error);
    }
}
